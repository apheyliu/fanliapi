自测功能列表
==============
 该文档用以合作商家开发接口时自测，以提高对接的效率。文档中提到的自测列表涵盖大多数易出错功能点，适用于CPS/CPN/P2P。

.. _test_jump:

跳转接口
----------

 A1、 用户入站即表示推广行为完成，记录返利网推广渠道及传入的跟踪参数；

 A2、 如果用户从其他渠道进入网站后，再从返利网跳转，推广渠道是否可以覆盖为返利网？

 A3、 是否支持target_url跳转至指定页面？为空时跳转至首页或约定的默认注册页面；

 A4、 是否因为target_url为空或跨域或特殊频道页，导致返利网推广渠道记录失败？

 A5、 是否对target_url格式有限制？默认应该是网站现有的任意url均可；

 A6、 是否因为uid为空或签名校验不通过，导致返利网推广渠道记录失败？默认不限制，用户访问了即为有效推广；

 A7、 推广有效期（RD）是否为约定长度？推广渠道的记录如采用cookies/Session是否存在跨域和有效期过短的问题？

 A8、 是否对传入的uid/tc参数与网站自有的用户进行了强制绑定？是否因为增加了绑定逻辑导致某些情况下的返利网推广渠道记录失败？

 A9、 如有商务约定（如P2P），用户跳转注册后可以在自有 APP平台进行下单/投资等，此时需要绑定uid/tc到网站账号，且在用户下单后，根据绑定的信息进行反馈；

 A10、 如存在上述绑定，则在用户后续可能的多次跳转时，是否将绑定的uid/tc信息更新为最新值；

 A11、 是否存在绑定用户注册来源渠道时，限定了一个或有限的几个注册页？

 A12、 如存在上述限制，该注册页是否存在超链接导致用户可能跳转至其他注册页？

 A13、 返利网传入的跟踪参数是否有日志记录，以备后续核查？可根据传入的tracking_id序列号查询；

.. _test_order:

订单报文处理
------------

 B1、 订单报文格式是否符合返利网文档要求及基本XML格式要求？

 B2、 uid及tc字段是否为注册时绑定值或多次跳转的最新值？

 B3、 订单状态status是否为当前最新？

 B4、 订单状态或数据发生变化时，lastmod是否更新为最新时间？

 B5、 isnewbuyer是否依据商务约定准确传值？1为新客/首投，0为老客/复投，2为不确定状态（按照约定后续仍有可能产生首投资格）；

 B6、 报文中的订单号是否与商城本身的订单列表显示一致？且后续结算也根据此订单号？

 B7、 订单报文是否完整返回整单内容？是否存在拆单情况？

 B8、 报文product节点是否存在不同SKU返回不同pid的情况？

 B9、 是否有退换货情况？退换货后，num、refund_num、realpay_fee信息是否正确更新？

 B10、佣金分类及佣金值计算是否按照商务及产品约定执行？

 B11、 订单及商品的extension扩展信息是否返回？P2P理财商家一般为用户注册信息及标的期限、利率、用券等信息；

 B12、 是否正确计算了realpay_fee字段值？该值是用以佣金结算的订单金额，并非实付款金额，该金额的计算规则由商务确定。

 B13、 报文字段是否含有特殊字符？如果有，请用<![CDATA[...]]>进行处理；

.. _test_push:

订单推送
---------

 C1、 是否在订单生成后立即推送订单？不论订单是否通过审核、付款、取消等；如果有商务约定的例外，请罗列订单推送返回的规则；

 C2、 订单状态发生变化时，如付款、取消，是否及时重新推送订单？

 C3、 是否存在因为uid/tc为空而没有推送返回该订单？

 C4、 是否存在属于返利网推广的订单，但因为订单不满足结佣规则而没有推送返回？

 C5、 是否存在部分类型的商品或订单不推送？如果有商务约定的例外，请罗列具体规则；

 C6、 返利网订单推送为标准POST请求，一般用x-www-form-urlencoded或raw方式。如采用kv键值对，key=Content；如以raw方式，body内容为完整订单报文；可参考postman工具进行测试；

.. _test_query:

订单查询
----------

 D1、 订单数据返回是否实时？如果非实时，请罗列具体返回规则？

 D2、 订单查询是否支持指定开始结束时间，且精确到秒？

 D3、 是否支持指定订单号查询订单详情？

 D4、 是否支持指定uid，查询对应绑定用户的订单？

 D5、 是否支持update=1/0参数，既可查询最新生成及状态发生更新的订单，也可查询历史某段时间内生成的订单？

 D6、 如果查询历史订单，返回的订单状态等信息是否为当前最新？

 D7、 接口查询是否存在请求频率/次数限制？

 D8、 是否存在因分页导致的多商品订单，拆单在多页返回？
 
